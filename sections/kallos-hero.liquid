<section class="kallos-hero" id="kallos-hero-{{ section.id }}">
  <div class="kallos-hero__inner">
    <div class="kallos-hero__text">
      <div class="kallos-hero__proof">
        <div class="kallos-hero__stars">
          {% for i in (1..5) %}
            <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
              <path d="m234.29 114.85-45 38.83L203 211.75a16.4 16.4 0 0 1-24.5 17.82L128 198.49l-50.53 31.08A16.4 16.4 0 0 1 53 211.75l13.76-58.07-45-38.83A16.46 16.46 0 0 1 31.08 86l59-4.76 22.76-55.08a16.36 16.36 0 0 1 30.27 0l22.75 55.08 59 4.76a16.46 16.46 0 0 1 9.37 28.86Z"/>
            </svg>
          {% endfor %}
        </div>
        <div class="kallos-hero__clients">
          <strong>+{{ section.settings.client_count }}</strong> {{ section.settings.client_text }}
        </div>
      </div>

      <h1 class="kallos-hero__title">
        <span class="kallos-title-wrapper">
          <span class="kallos-title-static">{{ section.settings.title_rich }}</span>
          <span class="kallos-title-inline">
            <span id="kallos-typed-{{ section.id }}"></span><span class="kallos-caret"></span>.
          </span>
        </span>
      </h1>

      <div class="kallos-hero__desc">
        {{ section.settings.description_rich }}
      </div>
    </div>

    <div class="kallos-hero__media">
      {% if section.settings.img_main %}
        <img
          src="{{ section.settings.img_main | image_url: width: 900 }}"
          class="kallos-img-fixed kallos-img-fixed--main"
          loading="lazy"
        >
      {% endif %}
      {% if section.settings.img_secondary %}
        <img
          src="{{ section.settings.img_secondary | image_url: width: 700 }}"
          class="kallos-img-fixed kallos-img-fixed--secondary"
          loading="lazy"
        >
      {% endif %}
    </div>
  </div>
</section>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');

  #kallos-hero-{{ section.id }}{
    --grad: {{ section.settings.gradient_color }};
    --text: {{ section.settings.text_color }};
    --star: {{ section.settings.star_color }};
    color: var(--text);
    position: relative;
    overflow: hidden;
  }

  #kallos-hero-{{ section.id }}::before{
    content:"";
    position:absolute;
    inset:0;
    background: linear-gradient(270deg, transparent 0%, var(--grad) 100%);
    z-index:0;
  }

  .kallos-hero__inner{
    max-width:1100px;
    margin:0 auto;
    padding:80px 20px;
    display:flex;
    align-items: flex-start;
    justify-content:space-between;
    gap:40px;
    position:relative;
    z-index:1;
    min-height: 600px;
  }

  .kallos-hero__text{
    width:45%;
    padding-top: 60px;
  }

  .kallos-hero__media{
    width:55%;
    height:550px;
    position:relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .kallos-img-fixed {
    position: absolute;
    animation: float-kallos 6s ease-in-out infinite;
    object-fit: contain;
    height: auto;
    transition: all 0.3s ease;
  }

  .kallos-img-fixed--main {
    z-index: 3;
    width: 380px;
    left: 0;
    top: 10%;
  }

  .kallos-img-fixed--secondary {
    z-index: 2;
    width: 280px;
    right: -10%;
    bottom: 10%;
    opacity: 0.9;
  }

  @keyframes float-kallos {
    0%,100%{ transform: translateY(0); }
    50%{ transform: translateY(-20px); }
  }

  .kallos-hero__proof{ display:flex; align-items:center; gap:10px; font-family:'Poppins',sans-serif; font-weight:700; font-size:18px; }
  .kallos-hero__stars{ color:var(--star); display:flex; gap:4px; }
  .kallos-hero__stars svg{ width:18px; height:18px; }

  /* Arreglo para el título unido */
  .kallos-hero__title{ font-family:'Poppins',sans-serif; font-weight:700; font-size:52px; line-height:1.1; margin-top:12px; }
  .kallos-title-wrapper { display: block; }
  .kallos-title-static { display: inline; }
  .kallos-title-static p { display: inline; margin: 0; }
  .kallos-title-inline { display: inline; white-space: nowrap; }

  #kallos-typed-{{ section.id }}{ display: inline; min-height: 1em; }
  .kallos-caret{ display: inline-block; border-right: 3px solid currentColor; height: 1em; margin-left: 2px; animation: blink 1s step-start infinite; vertical-align: middle; }
  @keyframes blink{ 50%{ border-color:transparent; } }
  .kallos-hero__desc{ margin-top:14px; font-family:'Poppins',sans-serif; font-size:18px; line-height:1.6; }

  @media(max-width:768px){
    #kallos-hero-{{ section.id }}{ padding-bottom: 40px; }
    #kallos-hero-{{ section.id }}::before{ background: linear-gradient(0deg, var(--grad) 65%, transparent 100%); }
    .kallos-hero__inner{ flex-direction:column; padding:10px 20px 40px; text-align:center; gap: 0px; min-height: auto; align-items: center; }

    .kallos-hero__media{
      width:100%;
      height:360px;
      order:1;
      margin: 10px 0 20px 0;
      display: block;
    }

    .kallos-img-fixed {
      left: 50% !important;
      right: auto !important;
      top: 0 !important;
    }

    .kallos-img-fixed--main {
      width: 230px;
      animation: float-mobile-main 6s ease-in-out infinite;
    }

    .kallos-img-fixed--secondary {
      width: 180px;
      animation: float-mobile-sec 6s ease-in-out infinite;
    }

    @keyframes float-mobile-main {
      0%,100%{ transform: translateX(-85%) translateY(10px); }
      50%{ transform: translateX(-85%) translateY(-5px); }
    }

    @keyframes float-mobile-sec {
      0%,100%{ transform: translateX(-10%) translateY(120px); }
      50%{ transform: translateX(-10%) translateY(105px); }
    }

    .kallos-hero__text{ width:100%; order:2; position: relative; z-index: 10; margin-top: 0; padding-top: 0; }
    .kallos-hero__proof{ justify-content: center; margin-bottom: 8px; }
    .kallos-hero__title{ font-size:32px; }

    /* Forzar que el texto y la animación se mantengan juntos en la misma línea */
    .kallos-title-static, .kallos-title-inline { display: inline; white-space: normal; }

    .kallos-hero__desc{ font-size:15px; }
  }
</style>

<script>
  (function(){
    var el = document.getElementById("kallos-typed-{{ section.id }}");
    if(!el) return;
    var words = [{% for block in section.blocks %}{{ block.settings.word | json }}{% unless forloop.last %},{% endunless %}{% endfor %}];
    if(!words.length) words=["cejas"];
    var i=0, j=0, del=false;
    function tick(){
      var w = words[i];
      var current = w.slice(0, j);
      el.innerHTML = current.length > 0 ? current : "&nbsp;";
      if(!del && j < w.length){ j++; setTimeout(tick, 120); }
      else if(del && j > 0){ j--; setTimeout(tick, 60); }
      else if(!del && j === w.length){ setTimeout(() => { del = true; tick(); }, 2000); }
      else if(del && j === 0){ del = false; i = (i + 1) % words.length; setTimeout(tick, 400); }
    }
    tick();
  })();
</script>

{% schema %}
{
  "name": "Kallos · Hero",
  "settings": [
    { "type": "color", "id": "gradient_color", "label": "Color degradado", "default": "#AC9651" },
    { "type": "color", "id": "text_color", "label": "Color texto", "default": "#FFFFFF" },
    { "type": "color", "id": "star_color", "label": "Color estrellas", "default": "#AC9651" },
    { "type": "text", "id": "client_count", "label": "Número clientes", "default": "10.000" },
    { "type": "text", "id": "client_text", "label": "Texto clientes", "default": "clientes Kallos" },
    { "type": "image_picker", "id": "img_main", "label": "Imagen principal (Izquierda)" },
    { "type": "image_picker", "id": "img_secondary", "label": "Imagen secundaria (Derecha)" },
    {
      "type": "richtext",
      "id": "title_rich",
      "label": "Título",
      "default": "<p>Más confianza, Más</p>"
    },
    {
      "type": "richtext",
      "id": "description_rich",
      "label": "Descripción",
      "default": "<p>Kallos. Líder en crecimiento capilar y cuidado de la piel.</p>"
    }
  ],
  "blocks": [
    {
      "type": "word",
      "name": "Palabra animada",
      "settings": [{ "type": "text", "id": "word", "label": "Texto", "default": "cejas" }]
    }
  ],
  "presets": [{ "name": "Kallos · Hero" }]
}
{% endschema %}
